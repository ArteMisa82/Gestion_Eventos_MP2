generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model autoridades {
  id_aut     String     @id @db.VarChar(10)
  ced_per    String     @db.VarChar(10)
  dir_aut    String     @db.VarChar(30)
  car_aut    String     @db.VarChar(20)
  id_fac     String     @db.VarChar(10)
  personas   personas   @relation(fields: [ced_per], references: [ced_per], onDelete: Cascade)
  facultades facultades @relation(fields: [id_fac], references: [id_fac], onDelete: Cascade)

  @@index([id_fac], map: "idx_autoridades_facultad")
}

model carreras {
  id_car     String     @id @db.VarChar(10)
  nom_car    String     @db.VarChar(25)
  id_fac     String     @db.VarChar(10)
  facultades facultades @relation(fields: [id_fac], references: [id_fac], onDelete: Cascade)
  nivel      nivel[]
}

model credenciales {
  ced_per  String   @id @db.VarChar(10)
  cor_per  String   @unique @db.VarChar(50)
  con_per  String   @db.VarChar(255)
  personas personas @relation(fields: [ced_per], references: [ced_per], onDelete: Cascade)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model detalle_eventos {
  id_det          String            @id @db.VarChar(10)
  id_evt          String            @db.VarChar(10)
  ced_aut         String            @db.VarChar(10)
  cup_det         Int
  not_det         Decimal           @db.Decimal(4, 2)
  hor_det         Decimal           @db.Decimal(4, 2)
  are_det         String            @db.VarChar(40)
  cat_det         String            @db.VarChar(20)
  personas        personas          @relation(fields: [ced_aut], references: [ced_per], onDelete: Cascade)
  eventos         eventos           @relation(fields: [id_evt], references: [id_evt], onDelete: Cascade)
  registro_evento registro_evento[]

  @@index([ced_aut], map: "idx_detalle_eventos_autoridad")
}

model detalle_informe {
  num_det_inf Int       @id @default(autoincrement())
  num_inf     Int
  reg_asi     DateTime? @db.Date
  not_det     Decimal   @db.Decimal(5, 2)
  informes    informes  @relation(fields: [num_inf], references: [num_inf], onDelete: Cascade)
}

model estudiantes {
  id_est   String   @id @db.VarChar(10)
  ced_est  String   @db.VarChar(10)
  id_niv   String   @db.VarChar(10)
  personas personas @relation(fields: [ced_est], references: [ced_per], onDelete: Cascade)
  nivel    nivel    @relation(fields: [id_niv], references: [id_niv], onDelete: Cascade)

  @@index([id_niv], map: "idx_estudiantes_nivel")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model eventos {
  id_evt          String            @id @db.VarChar(10)
  nom_evt         String            @db.VarChar(25)
  fec_evt         DateTime          @db.Date
  lug_evt         String            @db.VarChar(25)
  tip_evt         String            @db.VarChar(10)
  mod_evt         String            @db.VarChar(10)
  des_evt         String            @db.VarChar(255)
  sub_evt         String?           @db.VarChar(80)
  detalle_eventos detalle_eventos[]
  pagos           pagos[]
  requerimientos  requerimientos[]
  tarifas_evento  tarifas_evento[]

  @@index([fec_evt], map: "idx_eventos_fecha")
  @@index([tip_evt], map: "idx_eventos_tipo")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model facultades {
  id_fac      String        @id @db.VarChar(10)
  nom_fac     String        @db.VarChar(30)
  ubi_pre_fac String        @db.VarChar(15)
  mis_fac     String        @db.VarChar(255)
  vic_fac     String        @db.VarChar(255)
  autoridades autoridades[]
  carreras    carreras[]
}

model informes {
  num_inf           Int               @id @default(autoincrement())
  num_reg_per       Int
  detalle_informe   detalle_informe[]
  registro_personas registro_personas @relation(fields: [num_reg_per], references: [num_reg_per], onDelete: Cascade)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model nivel {
  id_niv          String            @id @db.VarChar(10)
  nom_niv         String            @db.VarChar(10)
  org_cur_niv     String            @db.VarChar(10)
  id_car          String            @db.VarChar(10)
  estudiantes     estudiantes[]
  carreras        carreras          @relation(fields: [id_car], references: [id_car], onDelete: Cascade)
  registro_evento registro_evento[]
}

model pagos {
  num_pag           Int               @id @default(autoincrement())
  id_evt            String            @db.VarChar(10)
  num_reg_per       Int
  val_pag           Decimal           @db.Decimal(5, 2)
  eventos           eventos           @relation(fields: [id_evt], references: [id_evt], onDelete: Cascade)
  registro_personas registro_personas @relation(fields: [num_reg_per], references: [num_reg_per], onDelete: Cascade)

  @@index([id_evt], map: "idx_pagos_evento")
}

model personas {
  ced_per           String              @id @db.VarChar(10)
  nom_per           String              @db.VarChar(20)
  ape_per           String              @db.VarChar(20)
  tel_per           String              @db.VarChar(10)
  autoridades       autoridades[]
  credenciales      credenciales?
  detalle_eventos   detalle_eventos[]
  estudiantes       estudiantes[]
  registro_personas registro_personas[]
}

model registro_evento {
  id_reg_evt        String              @id @db.VarChar(10)
  id_det            String              @db.VarChar(10)
  id_niv            String              @db.VarChar(10)
  detalle_eventos   detalle_eventos     @relation(fields: [id_det], references: [id_det], onDelete: Cascade)
  nivel             nivel               @relation(fields: [id_niv], references: [id_niv], onDelete: Cascade)
  registro_personas registro_personas[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model registro_personas {
  num_reg_per     Int             @id @default(autoincrement())
  ced_per         String          @db.VarChar(10)
  id_reg_evt      String          @db.VarChar(10)
  tip_par         String          @db.VarChar(10)
  fec_reg_per     DateTime        @default(dbgenerated("CURRENT_DATE")) @db.Date
  informes        informes[]
  pagos           pagos[]
  personas        personas        @relation(fields: [ced_per], references: [ced_per], onDelete: Cascade)
  registro_evento registro_evento @relation(fields: [id_reg_evt], references: [id_reg_evt], onDelete: Cascade)

  @@index([ced_per], map: "idx_registro_personas_cedula")
  @@index([fec_reg_per], map: "idx_registro_personas_fecha")
}

model requerimientos {
  id_rec  String  @id @db.VarChar(10)
  id_evt  String  @db.VarChar(10)
  des_rec String  @db.VarChar(255)
  url_req String  @db.VarChar(255)
  eventos eventos @relation(fields: [id_evt], references: [id_evt], onDelete: Cascade)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model tarifas_evento {
  id_tar_evt Int     @id @default(autoincrement())
  id_evt     String  @db.VarChar(10)
  tip_par    String  @db.VarChar(10)
  val_evt    Decimal @db.Decimal(10, 2)
  eventos    eventos @relation(fields: [id_evt], references: [id_evt], onDelete: Cascade)

  @@index([id_evt], map: "idx_tarifas_evento")
}

model usuarios {
  id_usu       Int      @id @default(autoincrement())
  cor_usu      String
  pas_usu      String
  ced_usu      String?  @unique
  nom_usu      String
  nom_seg_usu  String?
  ape_usu      String
  ape_seg_usu  String?
  tel_usu      String?
  img_usu      String?
  pdf_ced_usu  String?
  stu_usu      Int?
  niv_usu      String?
  adm_usu      Int       @default(0)
  Administrador Boolean  @default(false)
}

